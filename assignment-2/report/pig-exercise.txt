-- exercise 19.5.3.1
-- Load title-and-actor.txt and group on the title. The actors 
-- (along with their roles) should appear as a nested bag.
titles = LOAD 'title-and-actor.txt'
AS (title:chararray, actor:chararray, year:int, role:chararray);
titlegroup = GROUP titles BY title;
titleactor = FOREACH titlegroup GENERATE GROUP, titles.actor;
DUMP titleactor;

-- exercise 19.5.3.2
-- Load director-and-title.txt and group on the director name. 
-- Titles should appear as a nested bag.
directors = LOAD 'director-and-title.txt'
AS (director:chararray, title:chararray, year:int);
directorgroup = GROUP directors BY director;
directortitles = FOREACH directorgroup GENERATE GROUP, directors.title;
DUMP directortitles;

-- exercise 19.5.3.3 (NYF)
-- Apply the cogroup operator to associate a movie, its director 
-- and its actors from both sources.
grouped = COGROUP titleactor BY title, directortitles BY title;
DUMP grouped;

-- exercise 19.5.3.4 (NYF)
-- Write a PIG program that retrieves the actors that are also director of some
-- movie: output a tuple for each artist, with two nested bags, one with the 
-- movies s/he played a role in, and one with the movies s/he directed.


-- exercise 19.5.3.5 (NYF)
-- write a modified version that looks for artists that were both actors and 
-- director of a same movie.